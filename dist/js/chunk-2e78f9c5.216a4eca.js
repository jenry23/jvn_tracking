(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e78f9c5"],{"210e":function(t,e,s){},"2b2f":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"full-screen-map",attrs:{id:"app"}},[s("GoogleMap")],1)])])])},n=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("button",{staticClass:"btn btn-default maps-refresh",attrs:{type:"button"},on:{click:t.fetchMap}},[s("i",{staticClass:"material-icons"},[t._v(" refresh ")]),t._v("\n        Refresh\n    ")]),s("Modal",{attrs:{title:t.title,"modal-class":"modal-xl"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header",staticStyle:{"background-color":"rgb(34, 139, 34)"}},[s("i",{staticClass:"fa fa-university"}),s("strong",{staticStyle:{color:"white"}},[t._v("\n                            Navigation Maps")])]),s("div",{staticClass:"card-body"},[s("div",{staticClass:"anyClass",attrs:{id:"panel"}})])]),s("div",{staticClass:"card"},[s("div",{staticClass:"card-header",staticStyle:{"background-color":"rgb(34, 139, 34)"}},[s("i",{staticClass:"fa fa-university"}),s("strong",{staticStyle:{color:"white"}},[t._v("\n                            Passenger List")])]),s("div",{staticClass:"anyClass"},t._l(t.passenger,(function(e){return s("div",{key:e.id,staticClass:"card-body"},[1==e.pickup?s("div",[s("b",[t._v(t._s(e.name))]),t._v(" -\n                                "),s("i",{staticClass:"material-icons",staticStyle:{color:"green"}},[t._v("check")])]):s("div",[s("b",[t._v(t._s(e.name))]),t._v(" -\n                                "),s("i",{staticClass:"material-icons",staticStyle:{color:"red"}},[t._v("block")])])])})),0)])]),s("div",{staticClass:"col-md-8"},[s("gmap-map",{staticStyle:{width:"100%",height:"800px"},attrs:{center:t.one_center,zoom:18}},[s("DirectionsRenderer",{attrs:{origin:this.one_center,destination:this.destination,waypoints:this.waypts,travelMode:"DRIVING"}})],1)],1)])]),s("gmap-map",{ref:"mapRef",staticStyle:{width:"100%",height:"800px"},attrs:{center:this.center,zoom:15,options:{mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}}},[t._l(t.markers,(function(e,a){return s("gmap-marker",{key:a,attrs:{options:{preserveViewport:!0},position:e.position},on:{click:function(s){return t.toggleInfoWindow(e,a)}}})})),t._l(t.markers,(function(e,a){return s("div",{key:a},[s("gmap-info-window",{attrs:{options:t.infoOptions,position:e.position}},[s("div",{domProps:{innerHTML:t._s(t.infoContent=e.name)}})])],1)}))],2)],1)},i=[],r=s("aeac"),l=s("602f"),c=s("755e"),d=(s("5ac0"),{name:"GoogleMap",components:{DirectionsRenderer:l["a"]},data(){return{center:{lat:14.184794666666667,lng:121.283092},one_center:{lat:0,lng:0},waypts:[],destination:{lat:0,lng:0},passenger:[],currentPlace:null,showModal:!1,panel:"",title:"",markers:[],drivers:[],infoContent:"",infoWindowPos:{lat:0,lng:0},infoWinOpen:!0,currentMidx:null,infoOptions:{pixelOffset:{width:0,height:-35}}}},computed:{google:c["gmapApi"]},mounted(){this.renderMap()},methods:{fetchMap(){this.renderMap()},renderMap(){var t=this,e=r["c"].ref("driverTrips/");e.on("value",(function(e){const s=[];e.forEach((function(t){var e=t.key,a=t.val();if(0!=a.latitude){a.latitude,a.longitude;s.push({name:e,position:{lat:a.latitude,lng:a.longitude}})}})),t.markers=s})),this.$refs.mapRef&&this.$refs.mapRef.$mapPromise.then(t=>{const e=new google.maps.TrafficLayer;e.setMap(t);const s=new google.maps.LatLngBounds;for(let a of this.markers)s.extend(a.position);t.fitBounds(s)})},toggleInfoWindow:function(t,e){this.showModal=!0,1==this.showModal&&this.getOneData(t.name)},getInfoWindowContent:function(t){return`\n            <p class="title is-4">${t}</p>\n      `},getOneData(t){r["m"].where("status","==","On Going").where("vehicleID","==",t).onSnapshot(t=>{t.forEach(t=>{var e=t.data().vehicleID,s=t.data().routeID;this.updateData(e,s)})},t=>{console.log(t)})},updateData(t,e){this.title=t+" - "+e;const s=this;var a=r["c"].ref("driverTrips/");a.on("value",(function(e){var a=e.val()[t],n=parseFloat(a.latitude),o=parseFloat(a.longitude);s.one_center={lat:n,lng:o}})),r["m"].doc(e).onSnapshot(t=>{var e=t.data().passengerID,s=t.data().routeID;r["k"].doc(s).onSnapshot(t=>{var e=t.data(),s=e["destination"],a=e["pitstops"],n=[];r["g"].doc(s).onSnapshot(t=>{var e={lat:t.data().latitude,lng:t.data().longitude};this.destination=e}),a.forEach(t=>{r["g"].doc(t).onSnapshot(t=>{n.push({location:{lat:t.data().latitude,lng:t.data().longitude},stopover:!0})})}),this.waypts=n}),this.passenger=e})}}}),p=d,u=(s("8918"),s("2877")),m=Object(u["a"])(p,o,i,!1,null,null,null),g=m.exports,f=s("2f62"),h=s("3cc6"),v=s("3d02"),b={components:{GlobalSearch:v["a"],HeaderSettings:h["a"],GoogleMap:g},data(){return{xprops:{module:"MapRouteIndex",route:"map_route",permission_prefix:"map_route_"}}},beforeDestroy(){this.resetState()},computed:{...Object(f["c"])("MapRouteIndex",["data","total","loading"])},mounted(){},methods:{...Object(f["b"])("MapRouteIndex",["fetchIndexData","setQuery","resetState"])}},w=b,y=Object(u["a"])(w,a,n,!1,null,null,null);e["default"]=y.exports},"3cc6":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{name:"HeaderSettings"}},[t._m(0),s("div",{staticClass:"dropdown-menu p-2 mr-5"},[s("h5",{staticClass:"ml-2 mb-1"},[t._v("\n      "+t._s(t.$t("global.datatables.colvis"))+"\n    ")]),s("hr",{staticClass:"my-1"}),t._l(t.columns,(function(e,a){return s("div",{key:e.title+a},[s("div",{staticClass:"dropdown-item px-2 mt-0 mb-1",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.handleChange(e)}}},[t.isColVisible(e)?s("i",{staticClass:"material-icons text-success mr-2"},[t._v("\n          done\n        ")]):s("i",{staticClass:"material-icons text-rose mr-2"},[t._v("close")]),t._v("\n        "+t._s(t.$t(e.title))+"\n      ")])])})),s("hr",{staticClass:"my-1"}),s("button",{staticClass:"btn btn-default btn-sm pull-right",attrs:{type:"button"}},[t._v("\n      "+t._s(t.$t("global.close"))+"\n    ")])],2)])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"btn btn-default dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown"}},[s("i",{staticClass:"fa fa-cog"}),s("span",{staticClass:"caret"})])}],o={name:"HeaderSettings",props:["columns"],methods:{isColVisible(t){return"undefined"===typeof t.visible||""+t.visible==="true"},handleChange(t){this.$set(t,"visible",!this.isColVisible(t))}}},i=o,r=(s("b15f"),s("2877")),l=Object(r["a"])(i,a,n,!1,null,"b03a5c46",null);e["a"]=l.exports},"3d02":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group bmd-form-group",class:{"has-items":t.query.s,"is-focused":t.focus}},[s("label",{staticClass:"bmd-label-floating"},[t._v("\n    Search\n  ")]),s("div",{staticClass:"input-group"},[s("input",{staticClass:"form-control",attrs:{type:"text",name:"search"},domProps:{value:t.query.s},on:{input:function(e){return t.debounceSearch(e.target.value)},focus:function(e){t.focus=!0},blur:function(e){t.focus=!1}}}),0!==t.query.s.length?s("div",{staticClass:"btn btn-just-icon btn-round btn-link text-dark d-inline-block input-group-append m-0",staticStyle:{height:"36px"},on:{click:function(e){t.query.s=""}}},[s("i",{staticClass:"material-icons"},[t._v("clear")])]):t._e()])])},n=[],o={props:{query:{type:Object,require:!0}},data(){return{focus:!1}},methods:{debounceSearch:_.debounce((function(t){this.query.s=t,this.query.offset=0}),300)}},i=o,r=s("2877"),l=Object(r["a"])(i,a,n,!1,null,null,null);e["a"]=l.exports},"5ac0":function(t,e,s){},"602f":function(t,e,s){"use strict";var a=s("755e");e["a"]=Object(a["MapElementFactory"])({name:"directionsRenderer",ctr(){return window.google.maps.DirectionsRenderer},events:["directions_changed"],mappedProps:{options:{zoomControl:!1}},props:{origin:{type:Object},destination:{type:Object},waypoints:{type:Array},travelMode:{type:String}},afterCreate(t){let e=new window.google.maps.DirectionsService;this.$watch(()=>[this.origin,this.destination,this.waypoints,this.travelMode],()=>{let{origin:s,destination:a,waypoints:n,travelMode:o}=this;if(s&&a&&n&&o){new google.maps.DirectionsRenderer({suppressMarkers:!0});var i={start:new google.maps.MarkerImage("http://maps.google.com/mapfiles/ms/micons/blue.png",new google.maps.Size(44,32),new google.maps.Point(0,0),new google.maps.Point(22,32)),end:new google.maps.MarkerImage("http://maps.google.com/mapfiles/ms/micons/green.png",new google.maps.Size(44,32),new google.maps.Point(0,0),new google.maps.Point(22,32))};t.setOptions({preserveViewport:!0}),t.setPanel(document.getElementById("panel")),e.route({origin:s,destination:a,travelMode:o,waypoints:n,provideRouteAlternatives:!0,optimizeWaypoints:!0},(e,s)=>{t.setDirections(e);var a=e.routes[0].legs[0];console.log(a.start_location),r(a.start_location,i.start,"title"),r(a.end_location,i.end,"title")})}function r(t,e,s){new google.maps.Marker({position:t,icon:e,title:s})}})}})},8918:function(t,e,s){"use strict";s("f142")},b15f:function(t,e,s){"use strict";s("210e")},f142:function(t,e,s){}}]);
//# sourceMappingURL=chunk-2e78f9c5.216a4eca.js.map