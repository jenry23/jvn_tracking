{"version":3,"sources":["webpack:///./resources/adminapp/js/cruds/Tickets/Scan.vue?f55a","webpack:///./node_modules/firebase/app/dist/index.esm.js","webpack:///resources/adminapp/js/cruds/Tickets/Scan.vue","webpack:///./resources/adminapp/js/cruds/Tickets/Scan.vue?29db","webpack:///./resources/adminapp/js/cruds/Tickets/Scan.vue","webpack:///./resources/adminapp/js/cruds/Tickets/Scan.vue?37ee"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","class","fullscreen","on","onFullscreenChange","attrs","paintBoundingBox","onDecode","onInit","staticRenderFns","version","registerVersion","SDK_VERSION","component"],"mappings":"kJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,IAAI,UAAUC,MAAM,CAAEC,WAAYR,EAAIQ,YAAaC,GAAG,CAAC,iBAAmBT,EAAIU,qBAAqB,CAACN,EAAG,gBAAgB,CAACO,MAAM,CAAC,MAAQV,KAAKW,kBAAkBH,GAAG,CAAC,OAAST,EAAIa,SAAS,KAAOb,EAAIc,SAAS,CAACV,EAAG,gBAAgB,IAAI,IAC1UW,EAAkB,G,oCCElB,EAAO,WACPC,EAAU;;;;;;;;;;;;;;;;;AAkBd,aAASC,gBAAgB,EAAMD,EAAS,OACxC,aAASE,YAAcF,ECAvB,OACE,OACE,MAAJ,CACM,OAAN,OACM,YAAN,EACM,OAAN,KACM,sBAAN,EACM,OAAN,CACQ,OAAR,eACQ,MAAR,UACQ,kBAAR,cAIE,gBACE,KAAJ,cAEE,SAAF,IACA,0DACI,iBACE,OAAN,gBACA,uBAEA,oBAKE,MAAF,CACI,WAAJ,GACA,EACQ,KAAR,oBAEQ,KAAR,mBAKE,UACE,IAAJ,wBACA,cACI,EAAJ,KACA,OACA,MACA,aAEE,QAAF,IACA,yDACI,iBAAJ,KACM,IAAN,cACQ,MACE,aAAV,EAAY,EAAZ,EAAY,EAAZ,MAAY,EAAZ,OAAY,IACZ,EAEQ,EAAR,YACQ,EAAR,sBACQ,EAAR,sBAGI,YAAJ,GACM,KAAN,UACM,IAAN,wBACA,gBACM,EAAN,KACA,OACA,MACA,SACQ,IAAR,uBACA,gCACQ,GAAR,EACU,GAAV,2BACY,IAAZ,WACA,EACA,gCACY,EAAZ,QACc,YAAd,SACA,kBAGY,EAAZ,QACc,YACd,8CACgB,KAAhB,OACgB,GAAhB,KACgB,QAAhB,EACgB,WAAhB,WAIY,KAAZ,OACc,MAAd,0BACc,KAAd,SACc,KAAd,UACc,kBAAd,EACc,aAAd,EACc,gBAAd,EACc,kBAAd,KACc,mBAAd,iBAIU,KAAV,OACY,MAAZ,mCACY,KAAZ,UACY,kBAAZ,EACY,aAAZ,EACY,gBAAZ,EACY,kBAAZ,KACY,mBAAZ,eAKI,aAAJ,GACM,UACN,EACA,SACQ,QAAR,SAHC,QAKO,KAAR,2CAII,eAAJ,GACM,KAAN,SACM,KAAN,eACM,KAAN,cACA,kBACM,KAAN,WAGI,UACE,KAAN,eAGI,QACE,KAAN,cAGI,QAAJ,GACM,OAAN,gBACQ,OAAR,mBAGI,mBAAJ,GAKM,KAAN,8CAEI,oBAAJ,KACM,IAAN,uBACQ,GAAR,6BAEM,OAAN,GAEI,oBACE,MAAN,qBAEA,oBACQ,EAAR,oBACA,uBAEQ,EAAR,uBACA,0BAEQ,EAAR,0BACA,uBAEQ,EAAR,uBAII,iBACJ,wBACQ,SAAR,iBACA,6BAEQ,SAAR,sBACA,8BAEQ,SAAR,uBACA,2BAEQ,SAAR,sBChN2X,I,wBCQvXG,EAAY,eACd,EACApB,EACAgB,GACA,EACA,KACA,WACA,MAIa,aAAAI,E,2CCnBf","file":"js/chunk-b6cef4d4.644484bc.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"wrapper\",class:{ fullscreen: _vm.fullscreen },on:{\"fullscreenchange\":_vm.onFullscreenChange}},[_c('qrcode-stream',{attrs:{\"track\":this.paintBoundingBox},on:{\"decode\":_vm.onDecode,\"init\":_vm.onInit}},[_c('back-button')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import firebase from '@firebase/app';\nexport { default } from '@firebase/app';\n\nvar name = \"firebase\";\nvar version = \"8.6.4\";\n\n/**\r\n * @license\r\n * Copyright 2018 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfirebase.registerVersion(name, version, 'app');\r\nfirebase.SDK_VERSION = version;\n//# sourceMappingURL=index.esm.js.map\n","<template>\r\n    <div\r\n        :class=\"{ fullscreen: fullscreen }\"\r\n        ref=\"wrapper\"\r\n        @fullscreenchange=\"onFullscreenChange\"\r\n    >\r\n        <qrcode-stream\r\n            @decode=\"onDecode\"\r\n            @init=\"onInit\"\r\n            :track=\"this.paintBoundingBox\"\r\n        >\r\n            <back-button></back-button>\r\n            <!-- <button @click=\"back\" class=\"fullscreen-button\">back\r\n            </button> -->\r\n        </qrcode-stream>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from \"vuex\";\r\nimport * as fb from \"../../firebase\";\r\nimport firebase from \"firebase/app\";\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            camera: \"auto\",\r\n            fullscreen: true,\r\n            result: null,\r\n            showScanConfirmation: false,\r\n            xprops: {\r\n                module: \"TicketsIndex\",\r\n                route: \"tickets\",\r\n                permission_prefix: \"tickets_\",\r\n            },\r\n        };\r\n    },\r\n    beforeDestroy() {\r\n        this.resetState();\r\n    },\r\n    computed: {\r\n        ...mapGetters(\"TicketsIndex\", [\"data\", \"total\", \"loading\"]),\r\n        fullscreenIcon() {\r\n            if (this.fullscreen) {\r\n                return \"/fullscreen-exit.svg\";\r\n            } else {\r\n                return \"/fullscreen.svg\";\r\n            }\r\n        },\r\n    },\r\n\r\n    watch: {\r\n        fullscreen(enterFullscreen) {\r\n            if (enterFullscreen) {\r\n                this.requestFullscreen();\r\n            } else {\r\n                this.exitFullscreen();\r\n            }\r\n        },\r\n    },\r\n\r\n    mounted() {\r\n        var id = this.$route.params.id;\r\n        var ticketRef = fb.ticketsCollection.doc(id);\r\n        fb.ticketsCollection\r\n            .doc(id)\r\n            .get()\r\n            .then((response) => {});\r\n    },\r\n    methods: {\r\n        ...mapActions(\"TicketsIndex\", [\"setQuery\", \"resetState\"]),\r\n        paintBoundingBox(detectedCodes, ctx) {\r\n            for (const detectedCode of detectedCodes) {\r\n                const {\r\n                    boundingBox: { x, y, width, height },\r\n                } = detectedCode;\r\n\r\n                ctx.lineWidth = 2;\r\n                ctx.strokeStyle = \"#007bff\";\r\n                ctx.strokeRect(x, y, width, height);\r\n            }\r\n        },\r\n        codeScanned(code) {\r\n            this.scanned = code;\r\n            var id = this.$route.params.id;\r\n            var ticketRef = fb.ticketsCollection.doc(id);\r\n            fb.ticketsCollection\r\n                .doc(id)\r\n                .get()\r\n                .then((response) => {\r\n                    var passengerID = response.data().passengerID;\r\n                    var value = this.searchStringInArray(code, passengerID);\r\n                    if (value) {\r\n                        if (value.pickup == false || value.pickup == \"\") {\r\n                            var today = new Date();\r\n                            var time =\r\n                                today.getHours() + \":\" + today.getMinutes();\r\n                            ticketRef.update({\r\n                                passengerID: passengerID.filter(\r\n                                    (passenger) => passenger.id !== value.id\r\n                                ),\r\n                            });\r\n                            ticketRef.update({\r\n                                passengerID:\r\n                                    firebase.firestore.FieldValue.arrayUnion({\r\n                                        name: value.name,\r\n                                        id: value.id,\r\n                                        pickup: true,\r\n                                        start_time: time,\r\n                                    }),\r\n                            });\r\n                        } else {\r\n                            this.$swal({\r\n                                title: \"You are Already Scanned\",\r\n                                text: doc.name,\r\n                                type: \"warning\",\r\n                                showCancelButton: true,\r\n                                focusCancel: true,\r\n                                reverseButtons: true,\r\n                                confirmButtonText: \"OK\",\r\n                                confirmButtonColor: \"#dd4b39\",\r\n                            });\r\n                        }\r\n                    } else {\r\n                        this.$swal({\r\n                            title: \"You are not Register in this Van\",\r\n                            type: \"warning\",\r\n                            showCancelButton: true,\r\n                            focusCancel: true,\r\n                            reverseButtons: true,\r\n                            confirmButtonText: \"OK\",\r\n                            confirmButtonColor: \"#dd4b39\",\r\n                        });\r\n                    }\r\n                });\r\n        },\r\n        async onInit(promise) {\r\n            try {\r\n                await promise;\r\n            } catch (e) {\r\n                console.error(e);\r\n            } finally {\r\n                this.showScanConfirmation = this.camera === \"off\";\r\n            }\r\n        },\r\n\r\n        async onDecode(content) {\r\n            this.result = content;\r\n            this.codeScanned(content);\r\n            this.pause();\r\n            await this.timeout(8000);\r\n            this.unpause();\r\n        },\r\n\r\n        unpause() {\r\n            this.camera = \"auto\";\r\n        },\r\n\r\n        pause() {\r\n            this.camera = \"off\";\r\n        },\r\n\r\n        timeout(ms) {\r\n            return new Promise((resolve) => {\r\n                window.setTimeout(resolve, ms);\r\n            });\r\n        },\r\n        onFullscreenChange(event) {\r\n            // This becomes important when the user doesn't use the button to exit\r\n            // fullscreen but hits ESC on desktop, pushes a physical back button on\r\n            // mobile etc.\r\n\r\n            this.fullscreen = document.fullscreenElement !== null;\r\n        },\r\n        searchStringInArray(str, strArray) {\r\n            for (var j = 0; j < strArray.length; j++) {\r\n                if (strArray[j].id.match(str)) return strArray[j];\r\n            }\r\n            return -1;\r\n        },\r\n        requestFullscreen() {\r\n            const elem = this.$refs.wrapper;\r\n\r\n            if (elem.requestFullscreen) {\r\n                elem.requestFullscreen();\r\n            } else if (elem.mozRequestFullScreen) {\r\n                /* Firefox */\r\n                elem.mozRequestFullScreen();\r\n            } else if (elem.webkitRequestFullscreen) {\r\n                /* Chrome, Safari and Opera */\r\n                elem.webkitRequestFullscreen();\r\n            } else if (elem.msRequestFullscreen) {\r\n                /* IE/Edge */\r\n                elem.msRequestFullscreen();\r\n            }\r\n        },\r\n\r\n        exitFullscreen() {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                /* Firefox */\r\n                document.mozCancelFullScreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                /* Chrome, Safari and Opera */\r\n                document.webkitExitFullscreen();\r\n            } else if (document.msExitFullscreen) {\r\n                /* IE/Edge */\r\n                document.msExitFullscreen();\r\n            }\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style scoped>\r\n.fullscreen {\r\n    position: fixed;\r\n    z-index: 1000;\r\n    top: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    left: 0;\r\n}\r\n\r\n.fullscreen-button {\r\n    background-color: white;\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n    margin: 1rem;\r\n}\r\n.fullscreen-button img {\r\n    width: 2rem;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scan.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scan.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Scan.vue?vue&type=template&id=28328e32&scoped=true&\"\nimport script from \"./Scan.vue?vue&type=script&lang=js&\"\nexport * from \"./Scan.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Scan.vue?vue&type=style&index=0&id=28328e32&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"28328e32\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scan.vue?vue&type=style&index=0&id=28328e32&scoped=true&lang=css&\""],"sourceRoot":""}